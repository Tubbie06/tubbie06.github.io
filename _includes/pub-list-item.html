{% assign p = include.post %}
{% assign cat = p.category | downcase | strip %}

<div class="pub-item">
  <div class="pub-title"><strong>{{ p.title }}</strong></div>

  {%- assign authors_line = "" -%}
  {%- if p.authors -%}
    {%- if p.authors.first -%}
      {%- assign authors_line = p.authors | join: ", " -%}
    {%- else -%}
      {%- assign authors_line = p.authors -%}
    {%- endif -%}
  {%- elsif p.author -%}
    {%- assign authors_line = p.author -%}
  {%- elsif p.citation -%}
    {%- assign authors_line = p.citation | split: '(' | first | strip -%}
  {%- endif -%}
  {%- assign authors_line = authors_line | strip -%}

  {% if authors_line != "" %}
    <div class="pub-authors">
      {{ authors_line }}{% if p.date %}, {{ p.date | date: "%Y" }}{% endif %}
    </div>
  {% endif %}

  {%- comment -%} Button label depends on category {%- endcomment -%}
  {% assign btn_label = "Link" %}
  {% if cat == "preprint" %}
    {% assign btn_label = "arXiv" %}
  {% elsif cat == "article" %}
    {% assign btn_label = "Link to paper" %}
  {% elsif cat == "thesis" %}
    {% assign btn_label = "Thesis" %}
  {% endif %}

  <div class="pub-venue">
    {% if p.venue %}
      <span>{{ p.venue }}</span>
    {% endif %}

    {% if p.paperurl %}
      <a class="pub-btn" href="{{ p.paperurl }}" target="_blank" rel="noopener">{{ btn_label }}</a>
    {% elsif p.doi %}
      {% if p.doi contains "http" %}
        <a class="pub-btn" href="{{ p.doi }}" target="_blank" rel="noopener">DOI</a>
      {% else %}
        <a class="pub-btn" href="https://doi.org/{{ p.doi }}" target="_blank" rel="noopener">DOI</a>
      {% endif %}
    {% elsif p.venue_url %}
      <a class="pub-btn" href="{{ p.venue_url }}" target="_blank" rel="noopener">{{ btn_label }}</a>
    {% endif %}
  </div>
</div>
